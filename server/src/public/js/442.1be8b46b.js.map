{"version":3,"file":"js/442.1be8b46b.js","mappings":"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","sources":["webpack://my-finances/./src/pages/sale-form-page.vue?395b","webpack://my-finances/../server/src/types/sale.types.ts","webpack://my-finances/./src/pages/sale-form-page.vue?799c","webpack://my-finances/./src/pages/sale-form-page.vue"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = { class: \"container p-4\" }\nconst _hoisted_2 = { class: \"d-flex flex-column align-items-baseline gap-2 align-items-center\" }\nconst _hoisted_3 = { class: \"d-flex gap-2 align-items-center\" }\nconst _hoisted_4 = {\n  key: 0,\n  class: \"fs-6\"\n}\nconst _hoisted_5 = {\n  key: 1,\n  class: \"fs-6\"\n}\nconst _hoisted_6 = { class: \"fs-2 fw-bold\" }\nconst _hoisted_7 = { class: \"fs-6 fst-italic\" }\nconst _hoisted_8 = { class: \"d-flex flex-column align-items-start gap-3\" }\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"h2\", { class: \"fs-6 m-0\" }, [\n  /*#__PURE__*/_createElementVNode(\"label\", { for: \"date\" }, \"Fecha de venta\")\n], -1)\nconst _hoisted_10 = {\n  key: 0,\n  class: \"d-flex flex-column align-items-start gap-3\"\n}\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"h2\", { class: \"fs-6 m-0\" }, [\n  /*#__PURE__*/_createElementVNode(\"label\", { for: \"initialPayment\" }, \"Pago inicial\")\n], -1)\nconst _hoisted_12 = { for: \"initialPayment\" }\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"h2\", { class: \"fs-6 m-0 text-start\" }, \"Productos\", -1)\nconst _hoisted_14 = { class: \"input-group gap-0\" }\nconst _hoisted_15 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_16 = [\"onUpdate:modelValue\"]\nconst _hoisted_17 = [\"onUpdate:modelValue\"]\nconst _hoisted_18 = [\"onClick\"]\nconst _hoisted_19 = { class: \"errorMessages\" }\nconst _hoisted_20 = {\n  key: 0,\n  for: \"name\"\n}\nconst _hoisted_21 = {\n  key: 1,\n  for: \"quantity\"\n}\nconst _hoisted_22 = {\n  key: 2,\n  for: \"pricePerUnit\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Icon = _resolveComponent(\"Icon\")!\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n  const _component_FormButtons = _resolveComponent(\"FormButtons\")!\n\n  return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n    _createElementVNode(\"h1\", _hoisted_2, [\n      _createElementVNode(\"span\", _hoisted_3, [\n        _createVNode(_component_Icon, { name: \"new-sale\" }),\n        (_ctx.$route.name === 'newsale')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"Nueva venta realizada a\"))\n          : _createCommentVNode(\"\", true),\n        (_ctx.$route.name === 'editsale')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \"Editar venta realizada a\"))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_ctx.$route.query.clientName), 1),\n      _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_ctx.$route.query.clientNameDetails), 1)\n    ]),\n    _createElementVNode(\"form\", {\n      onSubmit: _cache[4] || (_cache[4] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.handleSubmit && _ctx.handleSubmit(...args)), [\"prevent\"])),\n      id: \"myform\",\n      class: \"d-flex flex-column gap-4 mt-4\"\n    }, [\n      _createElementVNode(\"div\", _hoisted_8, [\n        _hoisted_9,\n        _createVNode(_component_date_picker, {\n          class: \"date-picker\",\n          name: \"date\",\n          value: _ctx.formState.saleDate,\n          \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.formState.saleDate) = $event)),\n          formatter: _ctx.dateFormat\n        }, null, 8, [\"value\", \"formatter\"])\n      ]),\n      (_ctx.$route.name === 'newsale')\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n            _hoisted_11,\n            _withDirectives(_createElementVNode(\"input\", {\n              class: \"form-control\",\n              type: \"number\",\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.initialPayment) = $event)),\n              name: \"initialPayment\"\n            }, null, 512), [\n              [_vModelText, _ctx.initialPayment]\n            ]),\n            _createElementVNode(\"label\", _hoisted_12, _toDisplayString(_ctx.formErrors ? _ctx.formErrors.payments : ''), 1)\n          ]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", {\n        class: \"d-flex flex-column gap-3 overflow-scroll\",\n        ref: \"itemsRef\",\n        style: _normalizeStyle({ height: _ctx.itemsContainerHeight + 'px' })\n      }, [\n        _hoisted_13,\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.formState.items, (item, idx) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: 'item' + idx\n          }, [\n            _createElementVNode(\"div\", _hoisted_14, [\n              _withDirectives(_createElementVNode(\"input\", {\n                class: \"form-control name-field\",\n                \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].name) = $event),\n                onInput: ($event: any) => (_ctx.handlePress($event, idx)),\n                name: \"name\",\n                type: \"text\",\n                placeholder: \"Nombre\"\n              }, null, 40, _hoisted_15), [\n                [_vModelText, _ctx.formState.items[idx].name]\n              ]),\n              _withDirectives(_createElementVNode(\"input\", {\n                class: \"form-control quantity-field\",\n                \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].quantity) = $event),\n                name: \"quantity\",\n                type: \"number\",\n                onFocus: _cache[2] || (_cache[2] = ($event: any) => (($event.target as HTMLInputElement).select())),\n                onContextmenu: _cache[3] || (_cache[3] = _withModifiers(() => {}, [\"prevent\"]))\n              }, null, 40, _hoisted_16), [\n                [_vModelText, _ctx.formState.items[idx].quantity]\n              ]),\n              _withDirectives(_createElementVNode(\"input\", {\n                class: \"form-control price-field\",\n                \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].pricePerUnit) = $event),\n                name: \"pricePerUnit\",\n                type: \"number\",\n                placeholder: \"Precio\"\n              }, null, 8, _hoisted_17), [\n                [_vModelText, _ctx.formState.items[idx].pricePerUnit]\n              ]),\n              _createElementVNode(\"button\", {\n                class: \"btn btn-outline-danger delete-button\",\n                onClick: ($event: any) => (_ctx.handleRemove(idx)),\n                type: \"button\"\n              }, [\n                _createVNode(_component_Icon, { name: \"cross\" })\n              ], 8, _hoisted_18)\n            ]),\n            _createElementVNode(\"div\", _hoisted_19, [\n              (_ctx.formErrors && _ctx.formErrors[`name${idx}`])\n                ? (_openBlock(), _createElementBlock(\"label\", _hoisted_20, _toDisplayString(_ctx.formErrors[`name${idx}`]), 1))\n                : _createCommentVNode(\"\", true),\n              (_ctx.formErrors && _ctx.formErrors[`quantity${idx}`])\n                ? (_openBlock(), _createElementBlock(\"label\", _hoisted_21, _toDisplayString(_ctx.formErrors[`quantity${idx}`]), 1))\n                : _createCommentVNode(\"\", true),\n              (_ctx.formErrors && _ctx.formErrors[`pricePerUnit${idx}`])\n                ? (_openBlock(), _createElementBlock(\"label\", _hoisted_22, _toDisplayString(_ctx.formErrors[`pricePerUnit${idx}`]), 1))\n                : _createCommentVNode(\"\", true)\n            ])\n          ]))\n        }), 128))\n      ], 4)\n    ], 32),\n    _createVNode(_component_FormButtons, {\n      ref: \"actionsRef\",\n      confirmLabel: _ctx.$route.name === 'newsale' ? 'Confirmar venta' : 'Confirmar',\n      onFormSubmit: _ctx.handleSubmit,\n      cancelLabel: \"Cancelar\"\n    }, null, 8, [\"confirmLabel\", \"onFormSubmit\"])\n  ]))\n}","import { Types } from \"mongoose\";\nimport { Client, ClientResBody } from \"./client.types\";\nimport { Payment, PaymentPostReqBody, PaymentResBody } from \"./payment.types\";\n\ntype Item = {\n  name: string;\n  quantity: number;\n  pricePerUnit: number;\n}\n\ntype ItemResBody = Omit<Item, '_id'> & { _id: string };\n\ntype Sale = {\n  _id: Types.ObjectId;\n  saleDate: string;\n  items: Item[];\n  payments: Payment[];\n  saleValue: number;\n  paidAmount: number;\n  unpaidAmount: number;\n};\n\ntype SalePostReqBody = Pick<Sale, 'items'> & {\n  payments: PaymentPostReqBody[];\n  saleDate: Date;\n}\n\ntype SalePatchReqBody = Pick<Sale, 'items'> & {\n  saleDate: Date;\n};\n\ntype SaleResBody = Omit<Sale, '_id' | 'items' | 'payments'> & { \n  _id: string;\n  items: ItemResBody[],\n  payments: PaymentResBody[],\n}\n\ntype SaleFormData = SalePatchReqBody & Pick<Client, 'clientName' | 'clientNameDetails'>; // this should be called SaleFormPageData or smth like that\ntype ClientAndSaleResBody = Omit<ClientResBody, 'sales'> & { sales: SaleResBody }; // this should be plainly called ClientAndSaleData\ntype SaleDataForPaymentForm = Pick<Client, 'clientName' | 'clientNameDetails'> & Pick<Sale, 'unpaidAmount' | 'saleDate'>;\ntype SaleAfterPayment = Pick<Sale, 'paidAmount' | 'unpaidAmount'>;\n\nfunction isSalePostReqBody (saleReqBody: SalePostReqBody | SalePatchReqBody | SalePatchReqBody): saleReqBody is SalePostReqBody {\n  return (saleReqBody as SalePostReqBody).payments !== undefined;   \n};\n\nfunction isSaleFormResBody (saleResBody: SaleFormData | ClientAndSaleResBody): saleResBody is SaleFormData {\n  return (saleResBody as SaleFormData).items !== undefined;\n};\n\nfunction isClientAndSaleResBody (saleResBody: SaleFormData | ClientAndSaleResBody): saleResBody is ClientAndSaleResBody {\n  return (saleResBody as ClientAndSaleResBody).contactPhone !== undefined;\n};\n\nexport {\n  Item,\n  ItemResBody,\n  Payment,\n  Sale,\n  SaleResBody,\n  ClientAndSaleResBody,\n  SalePostReqBody,\n  SalePatchReqBody,\n  SaleFormData,\n  SaleAfterPayment,\n  isSalePostReqBody,\n  isSaleFormResBody,\n  isClientAndSaleResBody,\n  SaleDataForPaymentForm,\n}\n","\nimport Icon from '@/components/icon.vue'\nimport { format } from 'date-fns'\nimport DatePicker from 'vue-datepicker-next'\nimport 'vue-datepicker-next/index.css';\nimport { defineComponent } from 'vue'\nimport { State, Methods, Refs } from '@/types/pages/sale-form-page.types'\nimport { Empty } from '@/types/global.types'\nimport { SaleFormData, isSalePostReqBody } from '#backend/sale.types'\nimport FormButtons from '@/components/form-buttons.vue'\nimport http from '@/utils/axios-instance'\nimport { isAxiosError } from 'axios'\n\nconst itemInitialState = { \n  name: '', \n  quantity: 1, \n  pricePerUnit: NaN \n};\nexport default defineComponent<Empty, Empty, State, Empty, Methods>({\n  data () {\n    return {\n      itemsContainerHeight: 0,\n      initialPayment: 0,\n      formState: {\n        saleDate: new Date(),\n        items: [ { ...itemInitialState }, { ...itemInitialState } ],\n        ...this.$route.name === 'newsale' ? { payments: [] } : {}\n      },\n      formErrors: undefined,\n      dateFormat: {\n        stringify: (date) => {\n          return date ? format(date, 'dd/MM/yyyy') : ''\n        }\n      }\n    }\n  },\n  components: {\n    Icon,\n    DatePicker,\n    FormButtons\n  },\n  methods: {\n    async handleSubmit () {\n      console.log(JSON.stringify(this.formState, null, 2));\n      console.log('route name', this.$route.name);\n      try {\n        if (this.$route.name === 'newsale') {\n          if (!isSalePostReqBody(this.formState)) return;\n\n          const res = await http.patch(`/clients/${this.$route.params.clientid}/sales`, {\n            ...this.formState,\n            items: this.getExistentItems()\n          })\n\n          this.$router.push({ \n            name: 'sale', \n            params: { clientid: this.$route.params.clientid, saleid: res.data.saleId } \n          })\n        } \n\n        if(this.$route.name === 'editsale') {\n          await http.patch(`/clients/${this.$route.params.clientid}/sales/${this.$route.params.saleid}`, {\n            ...this.formState,\n            items: this.getExistentItems()\n          })\n\n          this.$router.push({ name: 'sale', params: this.$route.params })\n        }\n      } catch (err) {\n        if (isAxiosError(err)) {\n          this.formErrors = err.response?.data.validationError\n        }\n      }\n    },\n    async handleRemove (idxToRemove) {\n      const remainingItems = this.formState.items.filter((_, idx) => idxToRemove !== idx);\n      this.formState.items = remainingItems;\n    },\n    handlePress (e, idx) {\n      if ((e.target as HTMLInputElement).value.length !== 0 && idx === this.formState.items.length - 1) {\n        this.formState.items = [ ...this.formState.items, { ...itemInitialState } ]\n      }\n    },\n    getExistentItems () {\n      return this.formState.items.filter((_, idx) => idx !== this.formState.items.length - 1);\n    },\n    async getSaleData () {\n      try {\n        const { clientid, saleid } = this.$route.params;\n        if (this.$route.name === 'editsale') {\n          const res = await http.get<{ saleData: SaleFormData }>(`/clients/${clientid}/sales/${saleid}?filter=saleform`)\n          console.log('res', res.data.saleData);\n          const { saleDate, items, clientName, clientNameDetails } = res.data.saleData;\n          this.formState = { saleDate: new Date(saleDate), items: [ ...items, itemInitialState ] }\n          this.clientName = clientName\n          this.clientNameDetails = clientNameDetails\n        }\n      } catch (err) {\n        if (isAxiosError(err)) {\n          this.formErrors = err.response?.data\n        } else {\n          console.error(err)\n        }\n      }\n    }\n  },\n  watch: {\n    initialPayment (newValue) {\n      if (!isSalePostReqBody(this.formState)) return;\n      if (newValue > 0) {\n        this.formState.payments = [{\n          paymentDate: new Date(this.formState.saleDate), // the initial payment is always the same day as the sale date\n          amount: newValue,\n        }]\n      }\n    },\n    'formState.saleDate': function (newValue: Date) {\n      if (!isSalePostReqBody(this.formState)) return;\n      if (this.formState.payments.length) {\n        this.formState.payments[0].paymentDate = new Date(newValue)\n      }\n    },\n    formState (newValue) {\n      console.log('formState new value: ', JSON.stringify(newValue, null, 2))\n      return newValue.payments;\n    },\n    formErrors (newValue) {\n      console.log('formErrors', newValue);\n    }\n  },\n  async beforeMount () {\n    await this.getSaleData()\n  },\n  mounted () {\n    const { itemsRef, actionsRef } = this.$refs as Refs;\n    this.itemsContainerHeight = window.innerHeight - itemsRef.offsetTop - actionsRef.$el.clientHeight - 30;\n  },\n})\n","import { render } from \"./sale-form-page.vue?vue&type=template&id=5f899463&ts=true\"\nimport script from \"./sale-form-page.vue?vue&type=script&lang=ts\"\nexport * from \"./sale-form-page.vue?vue&type=script&lang=ts\"\n\nimport \"./sale-form-page.vue?vue&type=style&index=0&id=5f899463&lang=css\"\n\nimport exportComponent from \"/home/ghost-order/proyectos_personales/dev/my-finances/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","key","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_createElementVNode","for","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","render","_ctx","_cache","$props","$setup","$data","$options","_component_Icon","_resolveComponent","_component_date_picker","_component_FormButtons","_openBlock","_createElementBlock","_createVNode","name","$route","_createCommentVNode","_toDisplayString","query","clientName","clientNameDetails","onSubmit","_withModifiers","args","handleSubmit","id","value","formState","saleDate","$event","formatter","dateFormat","_withDirectives","type","initialPayment","_vModelText","formErrors","payments","ref","style","_normalizeStyle","height","itemsContainerHeight","_Fragment","_renderList","items","item","idx","onInput","handlePress","placeholder","quantity","onFocus","target","select","onContextmenu","pricePerUnit","onClick","handleRemove","confirmLabel","onFormSubmit","cancelLabel","isSalePostReqBody","saleReqBody","undefined","itemInitialState","NaN","defineComponent","data","Date","this","stringify","date","format","components","Icon","DatePicker","FormButtons","methods","async","console","log","JSON","res","http","params","clientid","getExistentItems","$router","push","saleid","saleId","err","isAxiosError","response","validationError","idxToRemove","remainingItems","filter","_","e","length","saleData","error","watch","newValue","paymentDate","amount","getSaleData","mounted","itemsRef","actionsRef","$refs","window","innerHeight","offsetTop","$el","clientHeight","__exports__"],"sourceRoot":""}