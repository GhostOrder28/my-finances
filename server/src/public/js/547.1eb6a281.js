"use strict";(self["webpackChunkmy_finances"]=self["webpackChunkmy_finances"]||[]).push([[547],{145:function(e,t,n){function l(e){const{tableRef:t}=e,n=t.children["0"],l=t.parentElement,a=Number(window.getComputedStyle(l).paddingBottom.slice(0,-2)),i=window.innerHeight-t.offsetTop-n.clientHeight-a;return i}n.d(t,{b:function(){return l}})},9151:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,r,o){const s=(0,l.up)("Icon"),c=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(c,{class:"back-link d-flex align-items-center gap-2 text-decoration-none text-dark-teal lh-1",to:n.url},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{name:"backlink"}),(0,l.Uk)(" "+(0,a.zw)(n.label),1)])),_:1},8,["to"])}var r=n(3784),o={props:{url:{type:Object,required:!0},label:{type:String,required:!0}},components:{Icon:r.Z}},s=n(89);const c=(0,s.Z)(o,[["render",i]]);var d=c},9530:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,r,o){const s=(0,l.up)("Icon");return(0,l.wg)(),(0,l.iD)("button",{class:"link-custom d-flex gap-2 align-items-center btn rounded-pill bg-red",type:"button",onClick:t[0]||(t[0]=t=>e.$emit(e.deleteEvent))},[(0,l._)("span",null,(0,a.zw)(e.label?"Eliminar":""),1),(0,l.Wm)(s,{name:"thrash"})])}var r=n(3784),o=(0,l.aZ)({props:{label:{type:Boolean,required:!1},deleteEvent:{type:String,required:!0}},components:{Icon:r.Z}}),s=n(89);const c=(0,s.Z)(o,[["render",i]]);var d=c},2845:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,r,o){const s=(0,l.up)("Icon"),c=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(c,{class:"link-custom d-flex gap-2 align-items-center btn rounded-pill bg-turquoise text-decoration-none",to:n.url},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(n.label?"Modificar":"")+" ",1),(0,l.Wm)(s,{name:"edit"})])),_:1},8,["to"])}var r=n(3784),o={props:{url:{type:Object,required:!0},label:{type:Boolean,required:!1}},components:{Icon:r.Z}},s=n(89);const c=(0,s.Z)(o,[["render",i]]);var d=c},7105:function(e,t,n){n.d(t,{Z:function(){return p}});var l=n(3396),a=n(7139);const i={class:"d-flex flex-column gap-4 justify-content-center align-items-center bg-white bg-opacity-75 position-fixed top-0 container px-5 vw-100 vh-100"},r={class:"fs-3 fw-bold text-dark-teal"},o={class:"d-flex gap-3 w-100"};function s(e,t,n,s,c,d){return(0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l._)("div",i,[(0,l._)("p",r,(0,a.zw)(n.body),1),(0,l._)("div",o,[(0,l._)("button",{class:"flex-grow-1 py-2 rounded-pill border-0 bg-blue text-light-purple",type:"button",onClick:t[0]||(t[0]=t=>e.$emit(n.confirmEvent))},(0,a.zw)(n.confirmLabel),1),(0,l._)("button",{class:"flex-grow-1 py-2 rounded-pill border-0 bg-red text-light-red",onClick:t[1]||(t[1]=t=>e.$emit(n.rejectEvent))},(0,a.zw)(n.rejectLabel),1)])])])}var c={props:{body:{type:String,required:!0},rejectLabel:{type:String,required:!0},confirmLabel:{type:String,required:!0},confirmEvent:{type:String,required:!0},rejectEvent:{type:String,required:!0}}},d=n(89);const u=(0,d.Z)(c,[["render",s]]);var p=u},5121:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,r,o){const s=(0,l.up)("Icon"),c=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(c,{class:"position-fixed bottom-0 end-0 m-3 py-2 px-3 rounded-pill d-flex gap-2 align-items-center fs-6 fw-bold bg-blue text-purple text-decoration-none",to:e.url},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.label)+" ",1),(0,l.Wm)(s,{name:"plus"})])),_:1},8,["to"])}var r=n(3784),o=(0,l.aZ)({props:{label:{type:String,required:!0},url:{type:Object,required:!0}},components:{Icon:r.Z}}),s=n(89);const c=(0,s.Z)(o,[["render",i]]);var d=c},7052:function(e,t,n){n.d(t,{Z:function(){return u}});var l=n(3396),a=n(7139);const i={class:"position-fixed top-0 d-flex flex-column justify-content-center align-items-center gap-3 w-100 vh-100 fs-5 fw-bold bg-white opacity-75"},r=(0,l._)("div",{class:"spinner-border text-green"},null,-1);function o(e,t,n,o,s,c){return(0,l.wg)(),(0,l.iD)("div",i,[r,(0,l._)("p",null,(0,a.zw)(n.msg),1)])}var s={props:{msg:{type:String,required:!1}}},c=n(89);const d=(0,c.Z)(s,[["render",o]]);var u=d},1578:function(e,t,n){n.d(t,{Z:function(){return m}});var l=n(3396),a=n(7139);const i={class:"d-flex flex-column align-items-start flex-grow-1"},r={class:"d-flex gap-1"},o={class:"fs-6"},s={class:"fs-2 fw-bolder"};function c(e,t,n,c,d,u){const p=(0,l.up)("Icon");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",r,[(0,l.Wm)(p,{name:n.icon},null,8,["name"]),(0,l._)("h2",o,(0,a.zw)(n.label),1)]),(0,l._)("span",s,"S/ "+(0,a.zw)(n.value),1)])}var d=n(3784),u={props:{icon:{required:!0,type:String},label:{required:!0,type:String},value:{required:!0,type:String}},components:{Icon:d.Z}},p=n(89);const f=(0,p.Z)(u,[["render",c]]);var m=f},8547:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var l=n(3396),a=n(7139);const i=e=>((0,l.dD)("data-v-eb0ba964"),e=e(),(0,l.Cn)(),e),r={class:"container d-flex flex-column bg-green px-4 py-3 gap-2"},o={class:"row"},s={class:"col-7 d-flex flex-column gap-1"},c={class:"fs-2 fw-bolder text-start m-0"},d={class:"d-flex align-items-center gap-1 fs-6 m-0"},u={key:0},p={class:"col-5"},f={class:"d-flex gap-3"},m={class:"container p-3"},g={ref:"tableRef",class:"table w-100 m-0"},b=i((()=>(0,l._)("thead",null,[(0,l._)("tr",{height:"50",class:"align-middle w-100 d-table"},[(0,l._)("th",{class:"border-0 sale-col fs-6 p-0 text-dark-teal text-start"},"Venta"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Total"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Pagado"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Deuda")])],-1))),w={key:0},y={class:"align-middle w-100 d-table"},v={class:"sale-col fs-6 text-start text-dark-teal"},h={class:"text-dark-teal text-opacity-50 fs-6"},x={class:"list-unstyled m-0"},D={class:"stats-col fs-6 text-end"},k={class:"stats-col fs-6 text-end"},_={class:"stats-col fs-6 text-end"};function Z(e,t,n,i,Z,C){const q=(0,l.up)("BackLink"),S=(0,l.up)("Icon"),j=(0,l.up)("StatItem"),I=(0,l.up)("EditButton"),$=(0,l.up)("DeleteButton"),z=(0,l.up)("router-link"),E=(0,l.up)("Modal"),L=(0,l.up)("PopupButton"),N=(0,l.up)("Spinner");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("section",r,[(0,l.Wm)(q,{label:"Regresar a clientes",url:{name:"clients"}}),(0,l._)("div",o,[(0,l._)("div",s,[(0,l._)("h1",c,(0,a.zw)(e.clientData?e.clientData.clientName:""),1),(0,l._)("address",d,[(0,l.Wm)(S,{name:"phone"}),e.clientData?.contactPhone?((0,l.wg)(),(0,l.iD)("span",u,(0,a.zw)(e.clientData.contactPhone),1)):(0,l.kq)("",!0)])]),(0,l._)("div",p,[(0,l.Wm)(j,{icon:"total-debt",label:"Deuda total",value:e.clientData?e.clientData.currentDebt:0},null,8,["value"])])]),(0,l._)("div",f,[(0,l.Wm)(I,{url:{name:"editclient",params:{clientid:e.$route.params.clientid},query:{clientName:e.clientData?.clientName,clientNameDetails:e.clientData?.clientNameDetails,contactPhone:e.clientData?.contactPhone}},label:!0},null,8,["url"]),(0,l.Wm)($,{deleteEvent:"deleteClientIntent",onDeleteClientIntent:e.declareClientDeletionIntent,label:!0},null,8,["onDeleteClientIntent"])])]),(0,l._)("section",m,[(0,l._)("table",g,[b,(0,l._)("tbody",{style:(0,a.j5)({height:e.tbodyHeight+"px"}),class:"d-block table-group-divider pb-5 overflow-scroll w-100"},[e.clientData?((0,l.wg)(),(0,l.iD)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.clientData.sales,((t,n)=>((0,l.wg)(),(0,l.j4)(z,{key:"sale"+n,to:`${e.$route.path}/sale/${t._id}`,class:"row-link d-block border-top px-0 py-3 text-dark-teal text-decoration-none"},{default:(0,l.w5)((()=>[(0,l._)("tr",y,[(0,l._)("td",v,[(0,l._)("time",h,(0,a.zw)(t.saleDate),1),(0,l._)("ul",x,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.items,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:"item"+t},(0,a.zw)(e.name),1)))),128))])]),(0,l._)("td",D,"S/ "+(0,a.zw)(t.saleValue),1),(0,l._)("td",k,"S/ "+(0,a.zw)(t.paidAmount),1),(0,l._)("td",_,"S/ "+(0,a.zw)(t.unpaidAmount),1)])])),_:2},1032,["to"])))),128))])):(0,l.kq)("",!0)],4)],512)]),e.displayClientDeletionConfirmation?((0,l.wg)(),(0,l.j4)(E,{key:0,body:"¿Deseas eliminar este cliente?",confirmLabel:"Sí, bórralo",rejectLabel:"No",confirmEvent:"deleteClient",rejectEvent:"reject",onDeleteClient:e.deleteClient,onReject:t[0]||(t[0]=t=>e.displayClientDeletionConfirmation=!1)},null,8,["onDeleteClient"])):(0,l.kq)("",!0),(0,l.Wm)(L,{label:"Nueva venta",url:{name:"newsale",params:{clientid:e.$route.params.clientid},query:{clientName:e.clientData?.clientName,clientNameDetails:e.clientData?.clientNameDetails}}},null,8,["url"]),e.isLoading?((0,l.wg)(),(0,l.j4)(N,{key:1})):(0,l.kq)("",!0)],64)}var C=n(1578),q=n(5121),S=n(3784),j=n(145),I=n(8898),$=n(9151),z=n(2845),E=n(9530),L=n(737),N=n(7105),B=n(7052),W=(0,l.aZ)({data(){return{displayClientDeletionConfirmation:!1,clientData:void 0,tbodyHeight:0,isLoading:!1}},methods:{async getClientData(){try{this.isLoading=!0;const e=await I.Z.get(`/clients/${this.$route.params.clientid}?single=true`),t=e.data.clientData.sales.map((e=>({...e,saleDate:(0,L.Z)(new Date(e.saleDate),"dd-MM-yyyy")})));this.isLoading=!1,this.clientData={...e.data.clientData,sales:t}}catch(e){throw this.isLoading=!1,new Error(`there was an error while requesting the list of clients, ${e}`)}},async deleteClient(){try{const{clientid:e}=this.$route.params,{_id:t}=this.$store.state;await I.Z["delete"](`/clients/${t}/${e}`),this.$router.back()}catch(e){throw new Error(`there was an error, ${e}`)}},declareClientDeletionIntent(){console.log("AAAA"),this.displayClientDeletionConfirmation=!0}},components:{Icon:S.Z,StatItem:C.Z,PopupButton:q.Z,BackLink:$.Z,EditButton:z.Z,DeleteButton:E.Z,Modal:N.Z,Spinner:B.Z},watch:{displayClientDeletionConfirmation(e){console.log(e)}},async beforeMount(){await this.getClientData()},mounted(){const e=(0,j.b)(this.$refs);console.log(e),this.tbodyHeight=e}}),H=n(89);const P=(0,H.Z)(W,[["render",Z],["__scopeId","data-v-eb0ba964"]]);var A=P}}]);
//# sourceMappingURL=547.1eb6a281.js.map