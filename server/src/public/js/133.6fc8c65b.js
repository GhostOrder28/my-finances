"use strict";(self["webpackChunkmy_finances"]=self["webpackChunkmy_finances"]||[]).push([[133],{145:function(e,t,n){function l(e){const{tableRef:t}=e,n=t.children["0"],l=t.parentElement,a=Number(window.getComputedStyle(l).paddingBottom.slice(0,-2)),i=window.innerHeight-t.offsetTop-n.clientHeight-a;return i}n.d(t,{b:function(){return l}})},9151:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,o,r){const c=(0,l.up)("Icon"),s=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(s,{class:"back-link d-flex align-items-center gap-2 text-decoration-none text-dark-teal lh-1",to:n.url},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{name:"backlink"}),(0,l.Uk)(" "+(0,a.zw)(n.label),1)])),_:1},8,["to"])}var o=n(3784),r={props:{url:{type:Object,required:!0},label:{type:String,required:!0}},components:{Icon:o.Z}},c=n(89);const s=(0,c.Z)(r,[["render",i]]);var d=s},9530:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,o,r){const c=(0,l.up)("Icon");return(0,l.wg)(),(0,l.iD)("button",{class:"link-custom d-flex gap-2 align-items-center btn rounded-pill bg-red",type:"button",onClick:t[0]||(t[0]=t=>e.$emit(e.deleteEvent))},[(0,l._)("span",null,(0,a.zw)(e.label?"Eliminar":""),1),(0,l.Wm)(c,{name:"thrash"})])}var o=n(3784),r=(0,l.aZ)({props:{label:{type:Boolean,required:!1},deleteEvent:{type:String,required:!0}},components:{Icon:o.Z}}),c=n(89);const s=(0,c.Z)(r,[["render",i]]);var d=s},2845:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,o,r){const c=(0,l.up)("Icon"),s=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(s,{class:"link-custom d-flex gap-2 align-items-center btn rounded-pill bg-turquoise text-decoration-none",to:n.url},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(n.label?"Modificar":"")+" ",1),(0,l.Wm)(c,{name:"edit"})])),_:1},8,["to"])}var o=n(3784),r={props:{url:{type:Object,required:!0},label:{type:Boolean,required:!1}},components:{Icon:o.Z}},c=n(89);const s=(0,c.Z)(r,[["render",i]]);var d=s},7105:function(e,t,n){n.d(t,{Z:function(){return p}});var l=n(3396),a=n(7139);const i={class:"d-flex flex-column gap-4 justify-content-center align-items-center bg-white bg-opacity-75 position-fixed top-0 container px-5 vw-100 vh-100"},o={class:"fs-3 fw-bold text-dark-teal"},r={class:"d-flex gap-3 w-100"};function c(e,t,n,c,s,d){return(0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l._)("div",i,[(0,l._)("p",o,(0,a.zw)(n.body),1),(0,l._)("div",r,[(0,l._)("button",{class:"flex-grow-1 py-2 rounded-pill border-0 bg-blue text-light-purple",type:"button",onClick:t[0]||(t[0]=t=>e.$emit(n.confirmEvent))},(0,a.zw)(n.confirmLabel),1),(0,l._)("button",{class:"flex-grow-1 py-2 rounded-pill border-0 bg-red text-light-red",onClick:t[1]||(t[1]=t=>e.$emit(n.rejectEvent))},(0,a.zw)(n.rejectLabel),1)])])])}var s={props:{body:{type:String,required:!0},rejectLabel:{type:String,required:!0},confirmLabel:{type:String,required:!0},confirmEvent:{type:String,required:!0},rejectEvent:{type:String,required:!0}}},d=n(89);const u=(0,d.Z)(s,[["render",c]]);var p=u},5121:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(3396),a=n(7139);function i(e,t,n,i,o,r){const c=(0,l.up)("Icon"),s=(0,l.up)("router-link");return(0,l.wg)(),(0,l.j4)(s,{class:"position-fixed bottom-0 end-0 m-3 py-2 px-3 rounded-pill d-flex gap-2 align-items-center fs-6 fw-bold bg-blue text-purple text-decoration-none",to:e.url},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.label)+" ",1),(0,l.Wm)(c,{name:"plus"})])),_:1},8,["to"])}var o=n(3784),r=(0,l.aZ)({props:{label:{type:String,required:!0},url:{type:Object,required:!0}},components:{Icon:o.Z}}),c=n(89);const s=(0,c.Z)(r,[["render",i]]);var d=s},1578:function(e,t,n){n.d(t,{Z:function(){return f}});var l=n(3396),a=n(7139);const i={class:"d-flex flex-column align-items-start flex-grow-1"},o={class:"d-flex gap-1"},r={class:"fs-6"},c={class:"fs-2 fw-bolder"};function s(e,t,n,s,d,u){const p=(0,l.up)("Icon");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",o,[(0,l.Wm)(p,{name:n.icon},null,8,["name"]),(0,l._)("h2",r,(0,a.zw)(n.label),1)]),(0,l._)("span",c,"S/ "+(0,a.zw)(n.value),1)])}var d=n(3784),u={props:{icon:{required:!0,type:String},label:{required:!0,type:String},value:{required:!0,type:String}},components:{Icon:d.Z}},p=n(89);const m=(0,p.Z)(u,[["render",s]]);var f=m},7133:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var l=n(3396),a=n(7139);const i=e=>((0,l.dD)("data-v-442a1432"),e=e(),(0,l.Cn)(),e),o={class:"container d-flex flex-column bg-green px-4 py-3 gap-2"},r={class:"row"},c={class:"col-7 d-flex flex-column gap-1"},s={class:"fs-2 fw-bolder text-start m-0"},d={class:"d-flex align-items-center gap-1 fs-6 m-0"},u={key:0},p={class:"col-5"},m={class:"d-flex gap-3"},f={class:"container p-3"},b={ref:"tableRef",class:"table w-100 m-0"},g=i((()=>(0,l._)("thead",null,[(0,l._)("tr",{height:"50",class:"align-middle w-100 d-table"},[(0,l._)("th",{class:"border-0 sale-col fs-6 p-0 text-dark-teal text-start"},"Venta"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Total"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Pagado"),(0,l._)("th",{class:"border-0 stats-col fs-6 p-0 text-dark-teal text-end"},"Deuda")])],-1))),w={key:0},y={class:"align-middle w-100 d-table"},D={class:"sale-col fs-6 text-start text-dark-teal"},v={class:"text-dark-teal text-opacity-50 fs-6"},x={class:"list-unstyled m-0"},h={class:"stats-col fs-6 text-end"},k={class:"stats-col fs-6 text-end"},_={class:"stats-col fs-6 text-end"};function Z(e,t,n,i,Z,C){const q=(0,l.up)("BackLink"),I=(0,l.up)("Icon"),j=(0,l.up)("StatItem"),S=(0,l.up)("EditButton"),$=(0,l.up)("DeleteButton"),z=(0,l.up)("router-link"),E=(0,l.up)("Modal"),N=(0,l.up)("PopupButton");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("section",o,[(0,l.Wm)(q,{label:"Regresar a clientes",url:{name:"clients"}}),(0,l._)("div",r,[(0,l._)("div",c,[(0,l._)("h1",s,(0,a.zw)(e.clientData?e.clientData.clientName:""),1),(0,l._)("address",d,[(0,l.Wm)(I,{name:"phone"}),e.clientData?.contactPhone?((0,l.wg)(),(0,l.iD)("span",u,(0,a.zw)(e.clientData.contactPhone),1)):(0,l.kq)("",!0)])]),(0,l._)("div",p,[(0,l.Wm)(j,{icon:"total-debt",label:"Deuda total",value:e.clientData?e.clientData.currentDebt:0},null,8,["value"])])]),(0,l._)("div",m,[(0,l.Wm)(S,{url:{name:"editclient",params:{clientid:e.$route.params.clientid},query:{clientName:e.clientData?.clientName,clientNameDetails:e.clientData?.clientNameDetails,contactPhone:e.clientData?.contactPhone}},label:!0},null,8,["url"]),(0,l.Wm)($,{deleteEvent:"deleteClientIntent",onDeleteClientIntent:e.declareClientDeletionIntent,label:!0},null,8,["onDeleteClientIntent"])])]),(0,l._)("section",f,[(0,l._)("table",b,[g,(0,l._)("tbody",{style:(0,a.j5)({height:e.tbodyHeight+"px"}),class:"d-block table-group-divider pb-5 overflow-scroll w-100"},[e.clientData?((0,l.wg)(),(0,l.iD)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.clientData.sales,((t,n)=>((0,l.wg)(),(0,l.j4)(z,{key:"sale"+n,to:`${e.$route.path}/sale/${t._id}`,class:"row-link d-block border-top px-0 py-3 text-dark-teal text-decoration-none"},{default:(0,l.w5)((()=>[(0,l._)("tr",y,[(0,l._)("td",D,[(0,l._)("time",v,(0,a.zw)(t.saleDate),1),(0,l._)("ul",x,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.items,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:"item"+t},(0,a.zw)(e.name),1)))),128))])]),(0,l._)("td",h,"S/ "+(0,a.zw)(t.saleValue),1),(0,l._)("td",k,"S/ "+(0,a.zw)(t.paidAmount),1),(0,l._)("td",_,"S/ "+(0,a.zw)(t.unpaidAmount),1)])])),_:2},1032,["to"])))),128))])):(0,l.kq)("",!0)],4)],512)]),e.displayClientDeletionConfirmation?((0,l.wg)(),(0,l.j4)(E,{key:0,body:"¿Deseas eliminar este cliente?",confirmLabel:"Sí, bórralo",rejectLabel:"No",confirmEvent:"deleteClient",rejectEvent:"reject",onDeleteClient:e.deleteClient,onReject:t[0]||(t[0]=t=>e.displayClientDeletionConfirmation=!1)},null,8,["onDeleteClient"])):(0,l.kq)("",!0),(0,l.Wm)(N,{label:"Nueva venta",url:{name:"newsale",params:{clientid:e.$route.params.clientid},query:{clientName:e.clientData?.clientName,clientNameDetails:e.clientData?.clientNameDetails}}},null,8,["url"])],64)}var C=n(1578),q=n(5121),I=n(3784),j=n(145),S=n(8898),$=n(9151),z=n(2845),E=n(9530),N=n(737),B=n(7105),W=(0,l.aZ)({data(){return{displayClientDeletionConfirmation:!1,clientData:void 0,tbodyHeight:0}},methods:{async getClientData(){try{const e=await S.Z.get(`/clients/${this.$route.params.clientid}?single=true`),t=e.data.clientData.sales.map((e=>({...e,saleDate:(0,N.Z)(new Date(e.saleDate),"dd-MM-yyyy")})));console.log("parsed res",t),this.clientData={...e.data.clientData,sales:t}}catch(e){console.error(e)}},async deleteClient(){try{const{clientid:e}=this.$route.params,{_id:t}=this.$store.state;await S.Z["delete"](`/clients/${t}/${e}`),this.$router.back()}catch(e){throw new Error(`there was an error, ${e}`)}},declareClientDeletionIntent(){console.log("AAAA"),this.displayClientDeletionConfirmation=!0}},components:{Icon:I.Z,StatItem:C.Z,PopupButton:q.Z,BackLink:$.Z,EditButton:z.Z,DeleteButton:E.Z,Modal:B.Z},watch:{displayClientDeletionConfirmation(e){console.log(e)}},async beforeMount(){await this.getClientData()},mounted(){const e=(0,j.b)(this.$refs);console.log(e),this.tbodyHeight=e}}),H=n(89);const L=(0,H.Z)(W,[["render",Z],["__scopeId","data-v-442a1432"]]);var P=L}}]);
//# sourceMappingURL=133.6fc8c65b.js.map