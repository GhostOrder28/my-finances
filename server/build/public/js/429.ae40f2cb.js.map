{"version":3,"file":"js/429.ae40f2cb.js","mappings":"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","sources":["webpack://my-finances/./src/pages/payment-form-page.vue?7521","webpack://my-finances/./src/pages/payment-form-page.vue?81ab","webpack://my-finances/./src/pages/payment-form-page.vue"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = { class: \"container p-4\" }\nconst _hoisted_2 = { class: \"d-flex flex-column align-items-baseline gap-2 align-items-center\" }\nconst _hoisted_3 = { class: \"d-flex gap-2 align-items-center\" }\nconst _hoisted_4 = {\n  key: 0,\n  class: \"fs-6\"\n}\nconst _hoisted_5 = {\n  key: 1,\n  class: \"fs-6\"\n}\nconst _hoisted_6 = { class: \"fs-2 fw-bold\" }\nconst _hoisted_7 = { class: \"fs-6 fst-italic\" }\nconst _hoisted_8 = { class: \"fs-6\" }\nconst _hoisted_9 = { class: \"d-flex flex-column align-items-start gap-3\" }\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"h2\", { class: \"fs-6 m-0\" }, [\n  /*#__PURE__*/_createElementVNode(\"label\", { for: \"date\" }, \"Fecha de venta *\")\n], -1)\nconst _hoisted_11 = { class: \"d-flex flex-column align-items-start gap-3\" }\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"h2\", { class: \"fs-6 m-0\" }, [\n  /*#__PURE__*/_createElementVNode(\"label\", { for: \"amountPaid\" }, \"Monto del pago *\")\n], -1)\nconst _hoisted_13 = { class: \"w-100 d-flex flex-column align-items-start\" }\nconst _hoisted_14 = { class: \"input-group\" }\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"input-group-text\" }, \"S/\", -1)\nconst _hoisted_16 = {\n  key: 0,\n  class: \"error-message mt-1\",\n  for: \"amountPaid\"\n}\nconst _hoisted_17 = { class: \"\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Icon = _resolveComponent(\"Icon\")!\n  const _component_date_picker = _resolveComponent(\"date-picker\")!\n  const _component_FormButtons = _resolveComponent(\"FormButtons\")!\n\n  return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n    _createElementVNode(\"h1\", _hoisted_2, [\n      _createElementVNode(\"span\", _hoisted_3, [\n        _createVNode(_component_Icon, { name: \"new-payment\" }),\n        (_ctx.$route.name === 'newpayment')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"Nuevo pago de\"))\n          : _createCommentVNode(\"\", true),\n        (_ctx.$route.name === 'editpayment')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \"Editar pago de\"))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_ctx.$route.query.clientName), 1),\n      _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_ctx.$route.query.clientNameDetails), 1),\n      _createElementVNode(\"span\", _hoisted_8, \"por una venta realizada el \" + _toDisplayString(_ctx.saleDate), 1)\n    ]),\n    _createElementVNode(\"form\", {\n      class: \"d-flex flex-column gap-3\",\n      onSubmit: _cache[2] || (_cache[2] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.handleSubmit && _ctx.handleSubmit(...args)), [\"prevent\"])),\n      id: \"myform\",\n      style: _normalizeStyle({ height: _ctx.formHeight + 'px' }),\n      ref: \"formRef\"\n    }, [\n      _createElementVNode(\"div\", _hoisted_9, [\n        _hoisted_10,\n        _createVNode(_component_date_picker, {\n          class: \"date-picker\",\n          name: \"date\",\n          value: _ctx.formState.paymentDate,\n          \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.formState.paymentDate) = $event)),\n          formatter: _ctx.dateFormat\n        }, null, 8, [\"value\", \"formatter\"])\n      ]),\n      _createElementVNode(\"div\", _hoisted_11, [\n        _hoisted_12,\n        _createElementVNode(\"div\", _hoisted_13, [\n          _createElementVNode(\"div\", _hoisted_14, [\n            _hoisted_15,\n            _withDirectives(_createElementVNode(\"input\", {\n              class: \"form-control\",\n              name: \"amountPaid\",\n              type: \"number\",\n              step: \"0.01\",\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.formState.amount) = $event))\n            }, null, 512), [\n              [_vModelText, _ctx.formState.amount]\n            ])\n          ]),\n          (_ctx.formErrors)\n            ? (_openBlock(), _createElementBlock(\"label\", _hoisted_16, _toDisplayString(_ctx.formErrors.amount), 1))\n            : _createCommentVNode(\"\", true)\n        ]),\n        _createElementVNode(\"span\", _hoisted_17, \"Actualmente su deuda es de S/ \" + _toDisplayString(_ctx.unpaidAmount), 1)\n      ])\n    ], 36),\n    _createVNode(_component_FormButtons, {\n      ref: \"actionsRef\",\n      onFormSubmit: _ctx.handleSubmit,\n      confirmLabel: _ctx.$route.name === 'newpayment' ? 'AÃ±adir pago' : 'Confirmar',\n      cancelLabel: \"Cancelar\"\n    }, null, 8, [\"onFormSubmit\", \"confirmLabel\"])\n  ]))\n}","\nimport Icon from '@/components/icon.vue'\nimport { format } from 'date-fns'\nimport { defineComponent } from 'vue';\nimport { State, Methods, Refs } from '@/types/pages/payment-form-page.types'\nimport { Empty } from '@/types/global.types';\nimport { SaleDataForPaymentForm } from '#backend/sale.types';\nimport { PaymentEditionData } from '#backend/payment.types';\nimport FormButtons from '@/components/form-buttons.vue'\nimport DatePicker from 'vue-datepicker-next'\nimport 'vue-datepicker-next/index.css';\nimport http from '@/utils/axios-instance';\nimport { isAxiosError } from 'axios';\n\nexport default defineComponent<Empty, Empty, State, Empty, Methods>({\n  data () {\n    return {\n      formHeight: 0,\n      clientName: '',\n      clientNameDetails: '',\n      saleDate: '',\n      unpaidAmount: NaN,\n      formState: {\n        paymentDate: new Date(),\n        amount: NaN,\n      },\n      formErrors: {},\n    }\n  },\n  components: {\n    Icon,\n    DatePicker,\n    FormButtons,\n  },\n  methods: {\n    async handleSubmit () {\n      try {\n        const { params: { clientid, saleid, paymentid }, name } = this.$route\n        if (name === 'newpayment') {\n          await http.patch(`/clients/${clientid}/sales/${saleid}/payments`, this.formState)\n        }\n        if (name === 'editpayment' && paymentid) {\n          await http.patch(`/clients/${clientid}/sales/${saleid}/payments/${paymentid}`, this.formState)\n        }\n        this.$router.push({ name: 'sale', params: { clientid, saleid } })\n      } catch (err) {\n        if (isAxiosError(err)) {\n          this.formErrors = err.response?.data.validationError\n        }\n      }\n    },\n    async getPaymentData () {\n      const { params: { clientid, saleid, paymentid }, name } = this.$route;\n      let res;\n\n      if (name === 'newpayment') {\n        res = await http.get<{ saleData: SaleDataForPaymentForm }>(`/clients/${clientid}/sales/${saleid}?filter=paymentform`);\n        const { clientName, clientNameDetails, unpaidAmount, saleDate } = res.data.saleData;\n        this.unpaidAmount = unpaidAmount\n        this.saleDate = format(new Date(saleDate), 'dd-MM-yyyy') \n      }\n\n      if (name === 'editpayment') {\n        res = await http.get<{ paymentData: PaymentEditionData }>(`/clients/${clientid}/sales/${saleid}/payments/${paymentid}`);\n        const { clientName, clientNameDetails, unpaidAmount, saleDate, paymentDate, amount } = res.data.paymentData;\n        this.formState = { paymentDate: new Date(paymentDate), amount }\n        this.unpaidAmount = unpaidAmount\n        this.saleDate = format(new Date(saleDate), 'dd-MM-yyyy') \n      }\n    }\n  },\n  async beforeMount () {\n    await this.getPaymentData()\n  },\n  mounted () {\n    const { formRef, actionsRef } = this.$refs as Refs;\n    console.log('window inner height', window.innerHeight);\n    console.log('form offset top', formRef.offsetTop);\n    console.log('actions ref height', actionsRef.$el);\n    this.formHeight = window.innerHeight - formRef.offsetTop - actionsRef.$el.clientHeight - 30;\n  },\n})\n","import { render } from \"./payment-form-page.vue?vue&type=template&id=9a103aa8&ts=true\"\nimport script from \"./payment-form-page.vue?vue&type=script&lang=ts\"\nexport * from \"./payment-form-page.vue?vue&type=script&lang=ts\"\n\nimport \"./payment-form-page.vue?vue&type=style&index=0&id=9a103aa8&lang=css\"\n\nimport exportComponent from \"/home/ghost/projects/dev/personal/my-finances/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","key","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_createElementVNode","for","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","render","_ctx","_cache","$props","$setup","$data","$options","_component_Icon","_resolveComponent","_component_date_picker","_component_FormButtons","_openBlock","_createElementBlock","_createVNode","name","$route","_createCommentVNode","_toDisplayString","query","clientName","clientNameDetails","saleDate","onSubmit","_withModifiers","args","handleSubmit","id","style","_normalizeStyle","height","formHeight","ref","value","formState","paymentDate","$event","formatter","dateFormat","_withDirectives","type","step","amount","_vModelText","formErrors","unpaidAmount","onFormSubmit","confirmLabel","cancelLabel","defineComponent","data","NaN","Date","components","Icon","DatePicker","FormButtons","methods","async","params","clientid","saleid","paymentid","this","http","$router","push","err","isAxiosError","response","validationError","res","saleData","format","paymentData","getPaymentData","mounted","formRef","actionsRef","$refs","console","log","window","innerHeight","offsetTop","$el","clientHeight","__exports__"],"sourceRoot":""}