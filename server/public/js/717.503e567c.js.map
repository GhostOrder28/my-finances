{"version":3,"file":"js/717.503e567c.js","mappings":"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","sources":["webpack://my-finances/./src/pages/sale-form-page.vue?c655","webpack://my-finances/../server/src/types/sale.types.ts","webpack://my-finances/./src/pages/sale-form-page.vue?799c","webpack://my-finances/./src/pages/sale-form-page.vue"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-be066f66\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { id: \"page-content\" }\nconst _hoisted_2 = { id: \"header\" }\nconst _hoisted_3 = {\n  key: 0,\n  id: \"description\"\n}\nconst _hoisted_4 = {\n  key: 1,\n  id: \"description\"\n}\nconst _hoisted_5 = { class: \"fh\" }\nconst _hoisted_6 = { class: \"description\" }\nconst _hoisted_7 = { class: \"input-container\" }\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"date\",\n  class: \"f-rs\"\n}, \"Fecha *\", -1))\nconst _hoisted_9 = {\n  for: \"date\",\n  class: \"f-rs\"\n}\nconst _hoisted_10 = {\n  key: 0,\n  class: \"input-container\"\n}\nconst _hoisted_11 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"initialPayment\",\n  class: \"f-rs\"\n}, \"Pago inicial\", -1))\nconst _hoisted_12 = {\n  for: \"initialPayment\",\n  class: \"f-rs\"\n}\nconst _hoisted_13 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { id: \"labels\" }, [\n  /*#__PURE__*/_createElementVNode(\"span\", { class: \"f-rs\" }, \"Producto / Cantidad\"),\n  /*#__PURE__*/_createElementVNode(\"span\", { class: \"f-rs\" }, \"Precio unitario\")\n], -1))\nconst _hoisted_14 = { class: \"content\" }\nconst _hoisted_15 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_16 = [\"onUpdate:modelValue\"]\nconst _hoisted_17 = [\"onUpdate:modelValue\"]\nconst _hoisted_18 = [\"onClick\"]\nconst _hoisted_19 = { class: \"errorMessages\" }\nconst _hoisted_20 = { for: \"name\" }\nconst _hoisted_21 = { for: \"quantity\" }\nconst _hoisted_22 = { for: \"pricePerUnit\" }\nconst _hoisted_23 = {\n  id: \"actions\",\n  ref: \"actionsRef\"\n}\nconst _hoisted_24 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  form: \"myform\",\n  class: \"action-button confirm f-rs\"\n}, \"Confirmar venta\", -1))\nconst _hoisted_25 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"button\",\n  class: \"action-button danger f-rs\"\n}, \"Cancelar\", -1))\nconst _hoisted_26 = [\n  _hoisted_24,\n  _hoisted_25\n]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Icon = _resolveComponent(\"Icon\")!\n\n  return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n    _createElementVNode(\"h1\", _hoisted_2, [\n      _createElementVNode(\"span\", null, [\n        _createVNode(_component_Icon, { name: \"new-sale\" }),\n        (_ctx.$route.name === 'newsale')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"Nueva venta realizada a\"))\n          : _createCommentVNode(\"\", true),\n        (_ctx.$route.name === 'editsale')\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"Editar venta realizada a\"))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"span\", _hoisted_5, _toDisplayString(_ctx.clientName), 1),\n      _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_ctx.clientNameDetails), 1)\n    ]),\n    _createElementVNode(\"form\", {\n      onSubmit: _cache[4] || (_cache[4] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.handleSubmit && _ctx.handleSubmit(...args)), [\"prevent\"])),\n      id: \"myform\"\n    }, [\n      _createElementVNode(\"div\", _hoisted_7, [\n        _hoisted_8,\n        _withDirectives(_createElementVNode(\"input\", {\n          type: \"date\",\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.formState.saleDate) = $event)),\n          name: \"date\"\n        }, null, 512), [\n          [_vModelText, _ctx.formState.saleDate]\n        ]),\n        _createElementVNode(\"label\", _hoisted_9, _toDisplayString(_ctx.formErrors ? _ctx.formErrors.date : ''), 1)\n      ]),\n      (_ctx.$route.name === 'newsale')\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n            _hoisted_11,\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"number\",\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.initialPayment) = $event)),\n              name: \"initialPayment\"\n            }, null, 512), [\n              [_vModelText, _ctx.initialPayment]\n            ]),\n            _createElementVNode(\"label\", _hoisted_12, _toDisplayString(_ctx.formErrors ? _ctx.formErrors.payments : ''), 1)\n          ]))\n        : _createCommentVNode(\"\", true),\n      _hoisted_13,\n      _createElementVNode(\"div\", {\n        id: \"items\",\n        ref: \"itemsRef\",\n        style: _normalizeStyle({ height: _ctx.itemsContainerHeight + 'px' })\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.formState.items, (item, idx) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: \"item\",\n            key: 'item' + idx\n          }, [\n            _createElementVNode(\"div\", _hoisted_14, [\n              _createElementVNode(\"div\", null, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].name) = $event),\n                  onInput: ($event: any) => (_ctx.handlePress($event, idx)),\n                  name: \"name\",\n                  type: \"text\",\n                  class: \"name\"\n                }, null, 40, _hoisted_15), [\n                  [_vModelText, _ctx.formState.items[idx].name]\n                ]),\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].quantity) = $event),\n                  name: \"quantity\",\n                  type: \"number\",\n                  class: \"quantity\",\n                  onFocus: _cache[2] || (_cache[2] = ($event: any) => (($event.target as HTMLInputElement).select())),\n                  onContextmenu: _cache[3] || (_cache[3] = _withModifiers(() => {}, [\"prevent\"]))\n                }, null, 40, _hoisted_16), [\n                  [_vModelText, _ctx.formState.items[idx].quantity]\n                ])\n              ]),\n              _createElementVNode(\"div\", null, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.formState.items[idx].pricePerUnit) = $event),\n                  name: \"pricePerUnit\",\n                  type: \"number\",\n                  class: \"price\"\n                }, null, 8, _hoisted_17), [\n                  [_vModelText, _ctx.formState.items[idx].pricePerUnit]\n                ]),\n                _createElementVNode(\"button\", {\n                  onClick: ($event: any) => (_ctx.handleRemove(idx)),\n                  type: \"button\",\n                  class: \"remove-btn\"\n                }, [\n                  _createVNode(_component_Icon, { name: \"cross\" })\n                ], 8, _hoisted_18)\n              ])\n            ]),\n            _createElementVNode(\"div\", _hoisted_19, [\n              _createElementVNode(\"label\", _hoisted_20, _toDisplayString(_ctx.formErrors ? _ctx.formErrors[`name${idx}`] : ''), 1),\n              _createElementVNode(\"label\", _hoisted_21, _toDisplayString(_ctx.formErrors ? _ctx.formErrors[`quantity${idx}`] : ''), 1),\n              _createElementVNode(\"label\", _hoisted_22, _toDisplayString(_ctx.formErrors ? _ctx.formErrors[`pricePerUnit${idx}`] : ''), 1)\n            ])\n          ]))\n        }), 128))\n      ], 4)\n    ], 32),\n    _createElementVNode(\"div\", _hoisted_23, _hoisted_26, 512)\n  ]))\n}","import { Types } from \"mongoose\";\nimport { Payment, PaymentPostReqBody, PaymentEditionData, PaymentResBody } from \"./payment.types\";\nimport { Client, ClientResBody } from \"./client.types\";\n\ntype Item = {\n  name: string;\n  quantity: number;\n  pricePerUnit: number;\n}\n\ntype ItemResBody = Omit<Item, '_id'> & { _id: string };\n\ntype Sale = {\n  _id: Types.ObjectId;\n  saleDate: string;\n  items: Item[];\n  payments: Payment[];\n  saleValue: number;\n  paidAmount: number;\n  unpaidAmount: number;\n};\n\ntype SalePostReqBody = Pick<Sale, 'saleDate' | 'items'> & {\n  payments: PaymentPostReqBody[];\n}\n\ntype SalePatchReqBody = Pick<Sale, 'saleDate' | 'items'>;\n\ntype SaleResBody = Omit<Sale, '_id' | 'items' | 'payments'> & { \n  _id: string;\n  items: ItemResBody[],\n  payments: PaymentResBody[],\n}\n\ntype SaleFormData = SalePatchReqBody & Pick<Client, 'clientName' | 'clientNameDetails'>; // this should be called SaleFormPageData or smth like that\ntype ClientAndSaleResBody = Omit<ClientResBody, 'sales'> & { sales: SaleResBody }; // this should be plainly called ClientAndSaleData\ntype SaleDataForPaymentForm = Pick<Client, 'clientName' | 'clientNameDetails'> & Pick<Sale, 'unpaidAmount' | 'saleDate'>;\n\nfunction isSalePostReqBody (saleReqBody: SalePostReqBody | SalePatchReqBody | SalePatchReqBody): saleReqBody is SalePostReqBody {\n  return (saleReqBody as SalePostReqBody).payments !== undefined;   \n};\n\nfunction isSaleFormResBody (saleResBody: SaleFormData | ClientAndSaleResBody): saleResBody is SaleFormData {\n  return (saleResBody as SaleFormData).items !== undefined;\n};\n\nfunction isClientAndSaleResBody (saleResBody: SaleFormData | ClientAndSaleResBody): saleResBody is ClientAndSaleResBody {\n  return (saleResBody as ClientAndSaleResBody).contactPhone !== undefined;\n};\n\nexport {\n  Item,\n  ItemResBody,\n  Payment,\n  Sale,\n  SaleResBody,\n  ClientAndSaleResBody,\n  SalePostReqBody,\n  SalePatchReqBody,\n  SaleFormData,\n  isSalePostReqBody,\n  isSaleFormResBody,\n  isClientAndSaleResBody,\n  SaleDataForPaymentForm,\n}\n","\nimport Icon from '@/components/icon.vue'\nimport { format } from 'date-fns'\nimport { defineComponent } from 'vue'\nimport { State, Methods, Refs } from '@/types/pages/sale-form-page.types'\nimport { Empty } from '@/types/global.types'\nimport { SaleFormData, isSalePostReqBody } from '#backend/sale.types'\nimport http from '@/utils/axios-instance'\nimport { isAxiosError } from 'axios'\n\nconst itemInitialState = { \n  name: '', \n  quantity: 1, \n  pricePerUnit: NaN \n};\nexport default defineComponent<Empty, Empty, State, Empty, Methods>({\n  data () {\n    return {\n      itemsContainerHeight: 0,\n      initialPayment: 0,\n      formState: {\n        saleDate: '',\n        items: [ { ...itemInitialState }, { ...itemInitialState } ],\n      },\n      formErrors: undefined\n    }\n  },\n  components: {\n    Icon\n  },\n  methods: {\n    async handleSubmit () {\n      console.log(JSON.stringify(this.formState, null, 2));\n      try {\n        if (this.$route.name === 'newsale') {\n          if (!isSalePostReqBody(this.formState)) return;\n          await http.patch(`/clients/${this.$route.params.clientid}/sales`, {\n            ...this.formState,\n            items: this.getExistentItems()\n          })\n        } \n        if(this.$route.name === 'editsale') {\n          await http.patch(`/clients/${this.$route.params.clientid}/sales/${this.$route.params.saleid}`, {\n            ...this.formState,\n            items: this.getExistentItems()\n          })\n        }\n      } catch (err) {\n        if (isAxiosError(err)) {\n          this.formErrors = err.response?.data.validationError\n        }\n      }\n    },\n    async handleRemove (idxToRemove) {\n      const remainingItems = this.formState.items.filter((_, idx) => idxToRemove !== idx);\n      this.formState.items = remainingItems;\n    },\n    handlePress (e, idx) {\n      if ((e.target as HTMLInputElement).value.length !== 0 && idx === this.formState.items.length - 1) {\n        this.formState.items = [ ...this.formState.items, { ...itemInitialState } ]\n      }\n    },\n    getExistentItems () {\n      return this.formState.items.filter((_, idx) => idx !== this.formState.items.length - 1);\n    },\n    async getSaleData () {\n      try {\n        const { clientid, saleid } = this.$route.params;\n        const res = await http.get<{ saleData: SaleFormData }>(`/clients/${clientid}/sales/${saleid}?filter=saleform`)\n        console.log('res', res.data.saleData);\n        const { saleDate, items, clientName, clientNameDetails } = res.data.saleData;\n        this.formState = { saleDate, items: [ ...items, itemInitialState ] }\n        this.clientName = clientName\n        this.clientNameDetails = clientNameDetails\n      } catch (err) {\n        if (isAxiosError(err)) {\n          this.formErrors = err.response?.data\n        } else {\n          console.error(err)\n        }\n      }\n    }\n  },\n  watch: {\n    initialPayment (newValue) {\n      if (!isSalePostReqBody(this.formState)) return;\n      if (newValue > 0) {\n        this.formState.payments = [{\n          paymentDate: this.formState.saleDate, // the initial payment is always the same day as the sale date\n          amount: newValue,\n        }]\n      }\n    },\n    formState (newValue) {\n      console.log('formState new value: ', JSON.stringify(newValue, null, 2))\n      return newValue.payments;\n    },\n    formErrors (newValue) {\n      console.log('formErrors', newValue);\n    }\n  },\n  async beforeMount () {\n    if (this.$route.name === 'editsale') {\n      await this.getSaleData()\n    }\n  },\n  mounted () {\n    const { itemsRef, actionsRef } = this.$refs as Refs;\n    console.log('window height', window.innerHeight);\n    console.log('itemsRef offset top', itemsRef.offsetTop);\n    console.log('route', this.$route);\n    this.itemsContainerHeight = window.innerHeight - itemsRef.offsetTop - actionsRef.clientHeight - 50;\n  },\n})\n","import { render } from \"./sale-form-page.vue?vue&type=template&id=be066f66&scoped=true&ts=true\"\nimport script from \"./sale-form-page.vue?vue&type=script&lang=ts\"\nexport * from \"./sale-form-page.vue?vue&type=script&lang=ts\"\n\nimport \"./sale-form-page.vue?vue&type=style&index=0&id=be066f66&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/ghost-order/proyectos_personales/dev/my-finances/client/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-be066f66\"]])\n\nexport default __exports__"],"names":["_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","id","_hoisted_2","_hoisted_3","key","_hoisted_4","_hoisted_5","class","_hoisted_6","_hoisted_7","_hoisted_8","_createElementVNode","for","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","ref","_hoisted_24","type","form","_hoisted_25","_hoisted_26","render","_ctx","_cache","$props","$setup","$data","$options","_component_Icon","_resolveComponent","_openBlock","_createElementBlock","_createVNode","name","$route","_createCommentVNode","_toDisplayString","clientName","clientNameDetails","onSubmit","_withModifiers","args","handleSubmit","_withDirectives","$event","formState","saleDate","_vModelText","formErrors","date","initialPayment","payments","style","_normalizeStyle","height","itemsContainerHeight","_Fragment","_renderList","items","item","idx","onInput","handlePress","quantity","onFocus","target","select","onContextmenu","pricePerUnit","onClick","handleRemove","isSalePostReqBody","saleReqBody","undefined","itemInitialState","NaN","defineComponent","data","components","Icon","methods","async","console","log","JSON","stringify","this","http","params","clientid","getExistentItems","saleid","err","isAxiosError","response","validationError","idxToRemove","remainingItems","filter","_","e","value","length","res","saleData","error","watch","newValue","paymentDate","amount","getSaleData","mounted","itemsRef","actionsRef","$refs","window","innerHeight","offsetTop","clientHeight","__exports__"],"sourceRoot":""}